#importando o pandas e o plotly
import pandas as pd
import plotly.graph_objects as go
import numpy as np

#dataframe
df = pd.read_csv('https://raw.githubusercontent.com/Beatrizvn/Codigo/main/numerodemortes.csv') 

#Pegando apenas os dados de 2017
dado_ano = df['Ano']==2017
dados = df[dado_ano]

#Definindo algumas coisas
dados['Mortes'] = dados['Mortes'].apply(np.int64) #trasformar o numero de mortes em int

dados['text'] = dados['Pais'] + '<br>Mortes: ' + dados['Mortes'].map(str) #o texto a ser mostrado ao passar o mouse

limites = ([(0,60),(61,120),(121,180),(181,240),(241,300)]) #range que definem cada cor das bolinhas
cores = ["royalblue","tomato","lightseagreen","orange","crimson"] #cor das bolinhas

#Grafico

figura = go.Figure()

for i in range(len(limites)): #len(limites) = 5
    lim = limites[i]
    dados_2 = dados[(dados['Mortes'] >= lim[0]) & (dados['Mortes'] < lim[1])] 
    figura.add_trace(go.Scattergeo(
            locationmode = 'ISO-3', #para achar o local de cada pais no mapa
            locations = dados_2['Codigo_ISO'], #a coluna onde estão o ISO para achar o local de cada pais no mapa
            text = dados_2['text'], #o texto a ser mostrado ao passar o mouse
            marker = dict(
                size = dados_2['Mortes'], #tamanho das bolinhas
                color = cores[i], #cor das bolinhas
                sizemode = 'area', 
                line_color = 'rgb(40,40,40)',
                line_width = 0.5,),
            name = '{0} - {1}'.format(lim[0],lim[1] #aparecer o 'nome' certo na coluna no limites 
            )))


#Mudando layout

figura.update_layout(
        title_text = 'O número anual de mortes atribuídas ao tabagismo por 100.000 pessoas em 2017',
        showlegend = True,
        legend_title = "Mortes"
)

figura.show()
